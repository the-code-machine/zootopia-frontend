(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{646:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},985:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>d,ic:()=>n,nO:()=>r});var s=a(1990),l=a(8084);let r=(0,s.zD)("vaccines/fetchVaccines",async(e,t)=>{try{return(await l.A.get("/vaccines")).data.map(e=>(e=>({id:e.id,petId:e.pet_id,vaccineType:e.vaccine_type,vaccineName:e.vaccine_name,vaccinationDate:e.vaccination_date,numberOfVaccinations:e.number_of_vaccinations,dueDate:e.vaccination_date,veterinarian:e.veterinarian,notes:e.notes,images:e.images||[]}))(e))}catch(e){var a,s;return t.rejectWithValue((null==(s=e.response)||null==(a=s.data)?void 0:a.error)||e.message)}}),n=(0,s.zD)("vaccines/createVaccine",async(e,t)=>{try{return(await l.A.post("/vaccines",e)).data}catch(e){var a,s;return t.rejectWithValue((null==(s=e.response)||null==(a=s.data)?void 0:a.error)||e.message)}}),c=(0,s.zD)("vaccines/updateVaccine",async(e,t)=>{try{let{id:t,...a}=e;return(await l.A.put("/vaccines/".concat(t),a)).data}catch(e){var a,s;return t.rejectWithValue((null==(s=e.response)||null==(a=s.data)?void 0:a.error)||e.message)}}),i=(0,s.zD)("vaccines/deleteVaccine",async(e,t)=>{try{return await l.A.delete("/vaccines/".concat(e)),e}catch(e){var a,s;return t.rejectWithValue((null==(s=e.response)||null==(a=s.data)?void 0:a.error)||e.message)}}),d=(0,s.Z0)({name:"vaccine",initialState:{loading:!1,error:null,vaccines:[]},reducers:{},extraReducers:e=>{e.addCase(r.pending,e=>{e.loading=!0,e.error=null}).addCase(r.fulfilled,(e,t)=>{e.loading=!1,e.vaccines=t.payload}).addCase(r.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.vaccines.push(t.payload)}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,t)=>{e.loading=!1;let a=e.vaccines.findIndex(e=>e.id===t.payload.id);-1!==a&&(e.vaccines[a]=t.payload)}).addCase(c.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,t)=>{e.loading=!1,e.vaccines=e.vaccines.filter(e=>e.id!==t.payload)}).addCase(i.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}).reducer},1154:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2274:(e,t,a)=>{"use strict";a.d(t,{G:()=>r,j:()=>l});var s=a(4540);let l=s.wA,r=s.d4},2355:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},3052:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},3485:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(5155),l=a(2115),r=a(2355),n=a(3052);let c=e=>{let{onDateSelect:t}=e,[a,c]=(0,l.useState)(new Date),[i,d]=(0,l.useState)(null),o=new Date;return o.setHours(0,0,0,0),a.getFullYear()===o.getFullYear()&&(a.getMonth(),o.getMonth()),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex space-x-4 items-center  border-b py-4 bg-white border-[#E7E7E7] justify-center",children:[(0,s.jsx)("button",{onClick:()=>{let e=new Date(a);e.setMonth(e.getMonth()-1),c(e)},className:"disabled:opacity-30 disabled:cursor-not-allowed",children:(0,s.jsx)(r.A,{className:"text-[#46D3E0]"})}),(0,s.jsx)("span",{className:"font-medium text-lg",children:a.toLocaleDateString("en-US",{year:"numeric",month:"long"})}),(0,s.jsx)("button",{onClick:()=>{let e=new Date(a);e.setMonth(e.getMonth()+1),c(e)},children:(0,s.jsx)(n.A,{className:"text-[#46D3E0]"})})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 text-center px-4 pt-4 text-xs bg-white font-medium text-[#BEC2CC]",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e,t)=>(0,s.jsx)("div",{className:"py-1",children:e},t))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-0.5 px-4 shadow-lg bg-white rounded-b-4xl mb-4 pb-3",children:(()=>{let e=a.getFullYear(),t=a.getMonth(),s=new Date(e,t,1).getDay(),l=new Date(e,t+1,0).getDate(),r=[];for(let e=0;e<s;e++)r.push({day:null,current:!1});for(let e=1;e<=l;e++)r.push({day:e,current:!0});return r})().map((e,l)=>(0,s.jsx)("div",{className:"relative text-center py-2",children:e.day?(0,s.jsxs)("button",{onClick:()=>(e=>{let s=new Date(a.getFullYear(),a.getMonth(),e);d(s),t(s)})(e.day),className:"w-8 h-8 flex flex-col items-center justify-center rounded-full mx-auto \n                  ".concat((e=>!!e&&!!i&&e===i.getDate()&&i.getMonth()===a.getMonth()&&i.getFullYear()===a.getFullYear())(e.day)&&"bg-[#46D3E0]/15 text-[#46D3E0]","\n                "),children:[e.day,(e=>{if(!e)return!1;let t=new Date;return e===t.getDate()&&a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()})(e.day)&&(0,s.jsx)("div",{className:"w-1 h-1 rounded-full bg-[#46D3E0] mx-auto "})]}):(0,s.jsx)("div",{className:"w-8 h-8"})},l))})]})}},4355:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},4416:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4559:(e,t,a)=>{"use strict";a.d(t,{T:()=>s});let s=a(9509).env.BACKEND_URL||"https://zootopia.webprvw.link/api"},5513:(e,t,a)=>{Promise.resolve().then(a.bind(a,7788))},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},6474:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},7788:(e,t,a)=>{"use strict";a.d(t,{default:()=>v});var s=a(5155),l=a(2115),r=a(2355),n=a(6474),c=a(4416),i=a(4355),d=a(1154),o=a(646),u=a(6874),m=a.n(u),x=a(5695),h=a(3485),g=a(2274),p=a(985),f=a(1990),b=a(8084);let v=()=>{let e=(0,x.useRouter)(),t=(0,g.j)(),{pets:a}=(0,g.G)(e=>e.pet),{loading:u,error:v}=(0,g.G)(e=>e.vaccine),[y,j]=(0,l.useState)([]),[w,N]=(0,l.useState)([]),[C,A]=(0,l.useState)(!0),[k,S]=(0,l.useState)(null),[D,B]=(0,l.useState)(!1),[E,M]=(0,l.useState)(null),[_,V]=(0,l.useState)(a[0]),[P,z]=(0,l.useState)(""),[F,R]=(0,l.useState)(""),[T,L]=(0,l.useState)(""),[Y,O]=(0,l.useState)(!1),[W,I]=(0,l.useState)(!1),[q,U]=(0,l.useState)(""),[G,H]=(0,l.useState)(""),[K,Z]=(0,l.useState)(""),[J,Q]=(0,l.useState)([]),[X,$]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{A(!0),S(null);try{let[e,t]=await Promise.all([b.A.get("/vaccine-types"),b.A.get("/vaccine-names")]);j(e.data),N(t.data)}catch(e){console.error("Failed to fetch vaccine definitions:",e),S("Could not load vaccine options. Please try again later.")}finally{A(!1)}})()},[]);let ee=(0,l.useMemo)(()=>q.trim()?y.filter(e=>e.name.toLowerCase().includes(q.toLowerCase())):y,[q,y]),et=(0,l.useMemo)(()=>G.trim()?w.filter(e=>e.name.toLowerCase().includes(G.toLowerCase())):w,[G,w]),ea=async()=>{if(!es||!_)return;let e={petId:Number(_.id),vaccineType:F,vaccineName:T,vaccinationDate:P,dueDate:P,numberOfVaccinations:parseInt(K,10),images:J.map(e=>e.preview)};try{let a=await t((0,p.ic)(e));(0,f.pH)(a),$(!0)}catch(e){console.error("Failed to create vaccine:",e)}},es=_&&F&&T&&P&&K;return(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsxs)("div",{className:"fixed top-0 px-4 w-full sm:max-w-3xl py-4 flex items-center justify-between border-[#E7E7E7] border z-10 bg-white",children:[(0,s.jsx)(m(),{href:"/dashboard",children:(0,s.jsx)(r.A,{className:"w-6 h-6"})}),(0,s.jsx)("h1",{className:"text-[20px] font-medium text-[#1B1B1C]",children:"Vaccine Registration"}),(0,s.jsx)("div",{className:"w-6"})]}),D?(0,s.jsxs)("div",{className:"p-4 space-y-6 pt-20 pb-24",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-[#1B1B1C]",children:"Vaccine Registration"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-[#1B1B1C] mb-3",children:"Whose Record Is This?"}),(0,s.jsx)("div",{className:"flex space-x-3 overflow-x-auto pb-2",children:a.map(e=>(0,s.jsxs)("button",{onClick:()=>V(e),className:"flex shrink-0 items-center p-3 rounded-xl border-2 transition-colors w-52 ".concat((null==_?void 0:_.id)===(null==e?void 0:e.id)?"border-cyan-400 bg-cyan-50":"border-gray-200 bg-white"),children:[(0,s.jsx)("img",{src:e.image||"https://placehold.co/100x100/E2E8F0/A0AEC0?text=Pet",alt:e.name,className:"w-12 h-12 object-cover rounded-full mr-3"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:e.name}),(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:e.breed})]})]},e.id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[#1B1B1C] mb-2",children:"Vaccine Type"}),(0,s.jsxs)("button",{onClick:()=>O(!0),className:"w-full rect-pet px-4 py-3 text-[#1B1B1C] flex justify-between items-center text-left",children:[(0,s.jsx)("span",{className:F?"":"text-gray-400",children:F||"Please select vaccine type"}),(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-500"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[#1B1B1C] mb-2",children:"Vaccine Name"}),(0,s.jsxs)("button",{onClick:()=>I(!0),className:"w-full rect-pet px-4 py-3 text-[#1B1B1C] flex justify-between items-center text-left",children:[(0,s.jsx)("span",{className:T?"":"text-gray-400",children:T||"Please select vaccine name"}),(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-500"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[#1B1B1C] mb-2",children:"Vaccine Date"}),(0,s.jsxs)("button",{onClick:()=>B(!1),className:"w-full rect-pet px-4 py-3 text-[#1B1B1C] flex justify-between items-center text-left",children:[(0,s.jsx)("span",{className:E?"":"text-gray-400",children:E?(e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,".").concat(a,".").concat(s)})(E):"Please select vaccine date"}),(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-500"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[#1B1B1C] mb-2",children:"Number Of Vaccinations"}),(0,s.jsx)("input",{min:1,type:"number",value:K,onChange:e=>Z(e.target.value),placeholder:"Please Enter Number Of Vaccinations",className:"w-full rect-pet px-4 py-3 text-[#1B1B1C]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[#1B1B1C] mb-2",children:"Photos"}),(0,s.jsxs)("div",{className:"flex gap-5 flex-wrap",children:[J.map(e=>(0,s.jsxs)("div",{className:"relative w-20 h-20",children:[(0,s.jsx)("img",{src:e.preview,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}),(0,s.jsx)("button",{onClick:()=>{var t;return t=e.id,void Q(e=>e.filter(e=>e.id!==t))},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",children:(0,s.jsx)(c.A,{size:12})})]},e.id)),(0,s.jsxs)("label",{className:"cursor-pointer w-20 h-20 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center",children:[(0,s.jsx)(i.A,{className:"w-8 h-8 text-gray-400"}),(0,s.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{Array.from(e.target.files||[]).forEach(e=>{if(e&&e.type.startsWith("image/")){let t=new FileReader;t.onload=t=>{var a;let s={id:Date.now().toString()+Math.random().toString(36).substr(2,9),file:e,preview:null==(a=t.target)?void 0:a.result};Q(e=>[...e,s])},t.readAsDataURL(e)}}),e.target.value=""},className:"hidden"})]})]})]})]}):(0,s.jsx)("div",{className:"pt-16",children:(0,s.jsx)(h.A,{onDateSelect:e=>{M(e),z((e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(s)})(e))}})}),(0,s.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-50 sm:max-w-3xl mx-auto",children:D?(0,s.jsx)("button",{onClick:ea,disabled:!es||u,className:"w-full bg-primary text-white py-4 rounded-lg font-medium text-lg disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center",children:u?(0,s.jsx)(d.A,{className:"animate-spin h-5 w-5 text-white"}):"Register"}):(0,s.jsx)("button",{onClick:()=>B(!0),disabled:!E,className:"w-full bg-primary text-white py-4 rounded-lg font-medium text-lg disabled:bg-gray-400",children:"Next"})}),Y&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:(0,s.jsxs)("div",{className:"bg-white w-full rounded-t-2xl p-4 max-h-[80vh] flex flex-col",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Select Vaccine Type"}),(0,s.jsx)("div",{className:"overflow-y-auto",children:C?(0,s.jsx)(d.A,{className:"animate-spin mx-auto"}):k?(0,s.jsx)("p",{className:"text-red-500 text-center",children:k}):ee.map(e=>(0,s.jsx)("button",{onClick:()=>{R(e.name),O(!1)},className:"w-full text-left p-3 hover:bg-gray-100 rounded-lg",children:e.name},e.id))}),(0,s.jsx)("button",{onClick:()=>O(!1),className:"mt-4 bg-gray-200 py-2 rounded-lg",children:"Close"})]})}),W&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:(0,s.jsxs)("div",{className:"bg-white w-full rounded-t-2xl p-4 max-h-[80vh] flex flex-col",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Select Vaccine Name"}),(0,s.jsx)("div",{className:"overflow-y-auto",children:C?(0,s.jsx)(d.A,{className:"animate-spin mx-auto"}):k?(0,s.jsx)("p",{className:"text-red-500 text-center",children:k}):et.map(e=>(0,s.jsx)("button",{onClick:()=>{L(e.name),I(!1)},className:"w-full text-left p-3 hover:bg-gray-100 rounded-lg",children:e.name},e.id))}),(0,s.jsx)("button",{onClick:()=>I(!1),className:"mt-4 bg-gray-200 py-2 rounded-lg",children:"Close"})]})}),X&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl p-8 text-center flex flex-col items-center max-w-sm mx-4",children:[(0,s.jsx)(o.A,{className:"w-16 h-16 text-green-500 mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Success!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"The vaccine record has been registered successfully."}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"w-full bg-primary text-white py-3 rounded-lg font-semibold text-lg",children:"Done"})]})})]})}},8084:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(3464),l=a(7383),r=a(4559);let n=s.A.create({baseURL:r.T});n.interceptors.request.use(e=>{let t=l.A.get("auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>{var t;let a=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!a._retry){a._retry=!0;try{let e=l.A.get("refresh_token");if(!e)throw Error("Missing refresh token");let t=(await s.A.post("".concat(r.T,"/auth/refresh"),{refresh_token:e})).data.token;return l.A.set("auth_token",t),a.headers.Authorization="Bearer ".concat(t),n(a)}catch(e){return console.error("Refresh token failed:",e),l.A.remove("auth_token"),l.A.remove("refresh_token"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});let c=n}},e=>{e.O(0,[122,540,990,95,441,964,358],()=>e(e.s=5513)),_N_E=e.O()}]);