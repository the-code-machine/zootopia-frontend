(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{646:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2274:(e,t,a)=>{"use strict";a.d(t,{G:()=>l,j:()=>s});var r=a(4540);let s=r.wA,l=r.d4},2355:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},2948:(e,t,a)=>{"use strict";a.d(t,{default:()=>f});var r=a(5155),s=a(2115),l=a(2355),d=a(4416),i=a(4355),n=a(646),c=a(6874),o=a.n(c),u=a(5695),h=a(3485),m=a(3566),x=a(2274),g=a(6561),p=a(1990);let f=()=>{let e=(0,u.useRouter)(),t=(0,x.j)(),{loading:a,error:c}=(0,x.G)(e=>e.medical),[f,y]=(0,s.useState)(!1),[w,j]=(0,s.useState)(null),[v,b]=(0,s.useState)(),[N,C]=(0,s.useState)(""),[D,A]=(0,s.useState)([]),[k,M]=(0,s.useState)(!1),[S,E]=(0,s.useState)(!1),V=async()=>{if(!w||!v||!N.trim())return;let e={petId:Number(v.id),title:"Vist History",date:w,userDetails:N,photos:D.map(e=>({imageData:e.preview,uploadedBy:"user"}))};try{let a=await t((0,g.Px)(e));(0,p.pH)(a),E(!0)}catch(e){console.error("Failed to register medical record:",e),alert("Error registering medical record. Please try again.")}},B=w&&v&&N.trim();return(0,r.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,r.jsxs)("div",{className:"fixed top-0 px-4 w-full sm:max-w-3xl py-4 flex items-center justify-between border-[#E7E7E7] border z-10 bg-white",children:[(0,r.jsx)(o(),{href:"/dashboard",children:(0,r.jsx)(l.A,{className:"w-6 h-6"})}),(0,r.jsx)("h1",{className:"text-[20px] font-medium text-[#1B1B1C]",children:"Medical History"}),(0,r.jsx)("div",{className:"w-6"})]}),f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"px-4 py-6 space-y-4 pt-20 pb-24",children:[(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 text-gray-600",children:[(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M12.6831 10.0571L9.14154 13.5987L7.31689 11.774C7.07275 11.5299 6.67725 11.5299 6.43311 11.774C6.18896 12.0182 6.18896 12.4137 6.43311 12.6578L8.69965 14.9244C8.82172 15.0464 8.98163 15.1075 9.14154 15.1075C9.30145 15.1075 9.46136 15.0464 9.58344 14.9244L13.5669 10.9409C13.811 10.6968 13.811 10.3013 13.5669 10.0571C13.3228 9.81299 12.9272 9.81299 12.6831 10.0571Z",fill:"#8E8E93"}),(0,r.jsx)("path",{d:"M15.625 2.47498H14.6875V1.875C14.6875 1.52985 14.4077 1.25 14.0625 1.25C13.7173 1.25 13.4375 1.52985 13.4375 1.875V2.47498H6.5625V1.875C6.5625 1.52985 6.28265 1.25 5.9375 1.25C5.59235 1.25 5.3125 1.52985 5.3125 1.875V2.47498H4.375C2.65198 2.47498 1.25 3.87695 1.25 5.59998V15.625C1.25 17.348 2.65198 18.75 4.375 18.75H15.625C17.348 18.75 18.75 17.348 18.75 15.625V5.59998C18.75 3.87695 17.348 2.47498 15.625 2.47498ZM2.5 5.59998C2.5 4.56604 3.34106 3.72498 4.375 3.72498H5.3125V4.32465C5.3125 4.6698 5.59235 4.94965 5.9375 4.94965C6.28265 4.94965 6.5625 4.6698 6.5625 4.32465V3.72498H13.4375V4.32465C13.4375 4.6698 13.7173 4.94965 14.0625 4.94965C14.4077 4.94965 14.6875 4.6698 14.6875 4.32465V3.72498H15.625C16.6589 3.72498 17.5 4.56604 17.5 5.59998V6.23108H2.5V5.59998ZM15.625 17.5H4.375C3.34106 17.5 2.5 16.6589 2.5 15.625V7.48108H17.5V15.625C17.5 16.6589 16.6589 17.5 15.625 17.5Z",fill:"#8E8E93"})]}),(0,r.jsx)("button",{className:"text-[16px] font-semibold",children:w?(e=>{if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?e:"".concat(t.getFullYear(),".").concat(String(t.getMonth()+1).padStart(2,"0"),".").concat(String(t.getDate()).padStart(2,"0"))})(w):"Select Date"})]})}),(0,r.jsx)(m.A,{selectedPet:v,onSelectPet:e=>b(e),showModal:k,setShowModal:M}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-gray-900 font-medium",children:"Detail"}),(0,r.jsx)("textarea",{value:N,rows:8,onChange:e=>C(e.target.value),placeholder:"Please Enter The Detail",className:"w-full h-40 px-4 py-3 rect-pet focus:outline-none mt-2 resize-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-gray-900 font-medium",children:"Photos"}),(0,r.jsxs)("div",{className:"flex gap-5 flex-wrap mt-3",children:[D.map(e=>(0,r.jsxs)("div",{className:"relative w-20 h-20",children:[(0,r.jsx)("img",{src:e.preview,alt:"Uploaded",className:"w-full h-full object-cover rounded-lg"}),(0,r.jsx)("button",{onClick:()=>{var t;return t=e.id,void A(e=>e.filter(e=>e.id!==t))},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",children:(0,r.jsx)(d.A,{size:12})})]},e.id)),(0,r.jsxs)("label",{className:"cursor-pointer w-20 h-20 rect-pet flex items-center justify-center border-2 border-dashed border-gray-300",children:[(0,r.jsx)(i.A,{className:"w-8 h-8 text-gray-400"}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{Array.from(e.target.files||[]).forEach(e=>{if(e&&e.type.startsWith("image/")){let t=new FileReader;t.onload=t=>{var a;let r={id:Date.now().toString()+Math.random().toString(36).substr(2,9),file:e,preview:null==(a=t.target)?void 0:a.result};A(e=>[...e,r])},t.readAsDataURL(e)}}),e.target.value=""},className:"hidden"})]})]})]})]}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-50 sm:max-w-3xl mx-auto",children:(0,r.jsx)("button",{onClick:V,disabled:!B||a,className:"w-full bg-primary text-white py-4 rounded-lg font-medium text-lg disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center",children:a?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Register"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"pt-16",children:(0,r.jsx)(h.A,{onDateSelect:e=>{j((e=>{let t=new Date(e),a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(s)})(e))}})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-50 sm:max-w-3xl mx-auto",children:(0,r.jsx)("button",{onClick:()=>y(!0),disabled:!w,className:"w-full bg-primary text-white py-4 rounded-lg font-medium text-lg disabled:bg-gray-400",children:"Next"})})]}),S&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-8 text-center flex flex-col items-center max-w-sm mx-4",children:[(0,r.jsx)(n.A,{className:"w-16 h-16 text-green-500 mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Success!"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"The medical record has been registered successfully."}),(0,r.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"w-full bg-primary text-white py-3 rounded-lg font-semibold text-lg",children:"Done"})]})})]})}},3052:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},3485:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(5155),s=a(2115),l=a(2355),d=a(3052);let i=e=>{let{onDateSelect:t}=e,[a,i]=(0,s.useState)(new Date),[n,c]=(0,s.useState)(null),o=new Date;return o.setHours(0,0,0,0),a.getFullYear()===o.getFullYear()&&(a.getMonth(),o.getMonth()),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex space-x-4 items-center  border-b py-4 bg-white border-[#E7E7E7] justify-center",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Date(a);e.setMonth(e.getMonth()-1),i(e)},className:"disabled:opacity-30 disabled:cursor-not-allowed",children:(0,r.jsx)(l.A,{className:"text-[#46D3E0]"})}),(0,r.jsx)("span",{className:"font-medium text-lg",children:a.toLocaleDateString("en-US",{year:"numeric",month:"long"})}),(0,r.jsx)("button",{onClick:()=>{let e=new Date(a);e.setMonth(e.getMonth()+1),i(e)},children:(0,r.jsx)(d.A,{className:"text-[#46D3E0]"})})]}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1 text-center px-4 pt-4 text-xs bg-white font-medium text-[#BEC2CC]",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e,t)=>(0,r.jsx)("div",{className:"py-1",children:e},t))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-0.5 px-4 shadow-lg bg-white rounded-b-4xl mb-4 pb-3",children:(()=>{let e=a.getFullYear(),t=a.getMonth(),r=new Date(e,t,1).getDay(),s=new Date(e,t+1,0).getDate(),l=[];for(let e=0;e<r;e++)l.push({day:null,current:!1});for(let e=1;e<=s;e++)l.push({day:e,current:!0});return l})().map((e,s)=>(0,r.jsx)("div",{className:"relative text-center py-2",children:e.day?(0,r.jsxs)("button",{onClick:()=>(e=>{let r=new Date(a.getFullYear(),a.getMonth(),e);c(r),t(r)})(e.day),className:"w-8 h-8 flex flex-col items-center justify-center rounded-full mx-auto \n                  ".concat((e=>!!e&&!!n&&e===n.getDate()&&n.getMonth()===a.getMonth()&&n.getFullYear()===a.getFullYear())(e.day)&&"bg-[#46D3E0]/15 text-[#46D3E0]","\n                "),children:[e.day,(e=>{if(!e)return!1;let t=new Date;return e===t.getDate()&&a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()})(e.day)&&(0,r.jsx)("div",{className:"w-1 h-1 rounded-full bg-[#46D3E0] mx-auto "})]}):(0,r.jsx)("div",{className:"w-8 h-8"})},s))})]})}},3566:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(5155),s=a(2274);a(2115);let l=e=>{let{selectedPet:t,onSelectPet:a,showModal:l,setShowModal:d}=e,{pets:i}=(0,s.G)(e=>e.pet);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("button",{onClick:()=>d(!0),className:"w-full p-3 text-left rect-pet focus:ring-2 flex justify-between items-center ".concat(t?"text-[#1B1B1C] font-semibold":""," "),children:[(0,r.jsxs)("div",{className:" flex space-x-1 justify-center items-center",children:[(0,r.jsx)("img",{src:null==t?void 0:t.image,alt:"",className:" rounded-full w-5 h-5"}),(0,r.jsx)("span",{children:t?"".concat(t.name):"Select pet"})]}),(0,r.jsx)("span",{children:(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 5.3335L8.06323 10.6668L4 5.3335L12 5.3335Z",fill:"#1B1B1C"})})})]}),l&&(0,r.jsx)("div",{className:"fixed md:mx-auto md:max-w-3xl inset-0 bg-black/30 z-50 flex items-end",onClick:e=>{e.target===e.currentTarget&&d(!1)},children:(0,r.jsx)("div",{className:"bg-white w-full max-h-[80vh] rounded-t-xl overflow-hidden",children:(0,r.jsx)("div",{className:"p-8 max-h-[36rem] overflow-y-auto",children:i.map(e=>{var s;let l=(null==t?void 0:t.id)===e.id;return(0,r.jsxs)("div",{onClick:()=>{a(e),d(!1)},className:"p-4 rounded mb-3 cursor-pointer transition-colors min-h-24\n                      ".concat(l?"border-primary bg-primary/10 border":"border-gray-200 border"),children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("span",{className:"text-lg font-semibold ".concat(e.id?"text-[#3BB8AF]":"text-[#6C6C70]"),children:e.name}),e.id&&(0,r.jsxs)("span",{className:"text-gray-600",children:["â€¢ ",e.type]})]})}),e.id&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[e.gender,e.is_neutered&&" (Neutering)"," |"," ",function(e){let t=new Date(e),a=new Date,r=a.getFullYear()-t.getFullYear(),s=a.getMonth()-t.getMonth(),l=a.getDate()-t.getDate();l<0&&(s-=1,l+=new Date(a.getFullYear(),a.getMonth(),0).getDate()),s<0&&(r-=1,s+=12);let d=[];return r>0&&d.push("".concat(r," year").concat(r>1?"s":"")),s>0&&d.push("".concat(s," month").concat(s>1?"s":"")),0===r&&0===s&&d.push("".concat(l," day").concat(l>1?"s":"")),d.join(", ")}(e.birthday)," |"," "]})]},null!=(s=e.id)?s:"unregistered")})})})})]})}},4355:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},4416:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4559:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});let r=a(9509).env.BACKEND_URL||"https://zootopia.webprvw.link/api"},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},6561:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>c,KB:()=>i,Px:()=>d,Yt:()=>l});var r=a(1990),s=a(8084);let l=(0,r.zD)("medical/fetchRecords",async(e,t)=>{try{return(await s.A.get("/medical-records")).data.map(e=>(e=>{var t;return{id:e.id,petId:e.pet_id,title:e.title,date:e.date,userDetails:e.user_details||void 0,hospitalDetails:e.hospital_details||void 0,photos:(null==(t=e.photos)?void 0:t.map(e=>({imageData:e.imageData,uploadedBy:e.uploadedBy})))||[]}})(e))}catch(e){var a,r;return t.rejectWithValue((null==(r=e.response)||null==(a=r.data)?void 0:a.error)||e.message)}}),d=(0,r.zD)("medical/createRecord",async(e,t)=>{try{return(await s.A.post("/medical-records",e)).data}catch(e){var a,r;return t.rejectWithValue((null==(r=e.response)||null==(a=r.data)?void 0:a.error)||e.message)}}),i=(0,r.zD)("medical/updateRecord",async(e,t)=>{try{let{id:t,...a}=e;return(await s.A.put("/medical-records/".concat(t),a)).data}catch(e){var a,r;return t.rejectWithValue((null==(r=e.response)||null==(a=r.data)?void 0:a.error)||e.message)}}),n=(0,r.zD)("medical/deleteRecord",async(e,t)=>{try{return await s.A.delete("/medical-records/".concat(e)),e}catch(e){var a,r;return t.rejectWithValue((null==(r=e.response)||null==(a=r.data)?void 0:a.error)||e.message)}}),c=(0,r.Z0)({name:"medical",initialState:{loading:!1,error:null,records:[]},reducers:{},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,t)=>{e.loading=!1,e.records=t.payload}).addCase(l.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,t)=>{e.loading=!1,e.records.push(t.payload)}).addCase(d.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,t)=>{e.loading=!1;let a=e.records.findIndex(e=>e.id===t.payload.id);-1!==a&&(e.records[a]=t.payload)}).addCase(i.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.records=e.records.filter(e=>e.id!==t.payload)}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}).reducer},7025:(e,t,a)=>{Promise.resolve().then(a.bind(a,2948))},8084:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(3464),s=a(7383),l=a(4559);let d=r.A.create({baseURL:l.T});d.interceptors.request.use(e=>{let t=s.A.get("auth_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),d.interceptors.response.use(e=>e,async e=>{var t;let a=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!a._retry){a._retry=!0;try{let e=s.A.get("refresh_token");if(!e)throw Error("Missing refresh token");let t=(await r.A.post("".concat(l.T,"/auth/refresh"),{refresh_token:e})).data.token;return s.A.set("auth_token",t),a.headers.Authorization="Bearer ".concat(t),d(a)}catch(e){return console.error("Refresh token failed:",e),s.A.remove("auth_token"),s.A.remove("refresh_token"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});let i=d}},e=>{e.O(0,[122,540,990,95,441,964,358],()=>e(e.s=7025)),_N_E=e.O()}]);