(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},985:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>o,ic:()=>l,nO:()=>d});var r=t(1990),n=t(8084);let d=(0,r.zD)("vaccines/fetchVaccines",async(e,a)=>{try{return(await n.A.get("/vaccines")).data.map(e=>(e=>({id:e.id,petId:e.pet_id,vaccineType:e.vaccine_type,vaccineName:e.vaccine_name,vaccinationDate:e.vaccination_date,numberOfVaccinations:e.number_of_vaccinations,dueDate:e.vaccination_date,veterinarian:e.veterinarian,notes:e.notes,images:e.images||[]}))(e))}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),l=(0,r.zD)("vaccines/createVaccine",async(e,a)=>{try{return(await n.A.post("/vaccines",e)).data}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),i=(0,r.zD)("vaccines/updateVaccine",async(e,a)=>{try{let{id:a,...t}=e;return(await n.A.put("/vaccines/".concat(a),t)).data}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),s=(0,r.zD)("vaccines/deleteVaccine",async(e,a)=>{try{return await n.A.delete("/vaccines/".concat(e)),e}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),o=(0,r.Z0)({name:"vaccine",initialState:{loading:!1,error:null,vaccines:[]},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.vaccines=a.payload}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.loading=!1,e.vaccines.push(a.payload)}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.loading=!1;let t=e.vaccines.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.vaccines[t]=a.payload)}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(s.pending,e=>{e.loading=!0,e.error=null}).addCase(s.fulfilled,(e,a)=>{e.loading=!1,e.vaccines=e.vaccines.filter(e=>e.id!==a.payload)}).addCase(s.rejected,(e,a)=>{e.loading=!1,e.error=a.payload})}}).reducer},2274:(e,a,t)=>{"use strict";t.d(a,{G:()=>d,j:()=>n});var r=t(4540);let n=r.wA,d=r.d4},4147:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5cfdac",variable:"__variable_5cfdac"}},4183:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>o,sK:()=>d});var r=t(1990),n=t(8084);let d=(0,r.zD)("vaccineHistory/fetchHistory",async(e,a)=>{try{let a=await n.A.get("/vaccines/".concat(e,"/history"));return{vaccineId:e,data:a.data.map(e=>(e=>({id:e.id,vaccineId:e.vaccine_id,petId:e.pet_id,treatmentInfo:e.treatment_info,dateAdministered:e.date_administered,photos:e.photos||[]}))(e))}}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),l=(0,r.zD)("vaccineHistory/createHistory",async(e,a)=>{try{let{vaccineId:a,...t}=e;return(await n.A.post("/vaccines/".concat(a,"/history"),t)).data}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),i=(0,r.zD)("vaccineHistory/updateHistory",async(e,a)=>{try{let{id:a,vaccineId:t,...r}=e;return(await n.A.put("/vaccines/".concat(t,"/history/").concat(a),r)).data}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),s=(0,r.zD)("vaccineHistory/deleteHistory",async(e,a)=>{let{vaccineId:t,historyId:r}=e;try{return await n.A.delete("/vaccines/".concat(t,"/history/").concat(r)),{vaccineId:t,historyId:r}}catch(e){var d,l;return a.rejectWithValue((null==(l=e.response)||null==(d=l.data)?void 0:d.error)||e.message)}}),o=(0,r.Z0)({name:"vaccineHistory",initialState:{loading:!1,error:null,histories:{}},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.histories[a.payload.vaccineId]=a.payload.data}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(l.fulfilled,(e,a)=>{let{vaccineId:t}=a.payload;e.histories[t]||(e.histories[t]=[]),e.histories[t].push(a.payload)}).addCase(i.fulfilled,(e,a)=>{let{vaccineId:t,id:r}=a.payload,n=e.histories[t];if(n){let e=n.findIndex(e=>e.id===r);-1!==e&&(n[e]=a.payload)}}).addCase(s.fulfilled,(e,a)=>{let{vaccineId:t,historyId:r}=a.payload,n=e.histories[t];n&&(e.histories[t]=n.filter(e=>e.id!==r))}).addMatcher(e=>[l.pending,i.pending,s.pending].includes(e.type),e=>{e.loading=!0,e.error=null}).addMatcher(e=>[l.rejected,i.rejected,s.rejected,l.fulfilled,i.fulfilled,s.fulfilled].includes(e.type),(e,a)=>{e.loading=!1,a.type.endsWith("rejected")&&(e.error=a.payload)})}}).reducer},4559:(e,a,t)=>{"use strict";t.d(a,{T:()=>r});let r=t(9509).env.BACKEND_URL||"https://zootopia.webprvw.link/api"},5695:(e,a,t)=>{"use strict";var r=t(8999);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}})},6561:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>o,KB:()=>i,Px:()=>l,Yt:()=>d});var r=t(1990),n=t(8084);let d=(0,r.zD)("medical/fetchRecords",async(e,a)=>{try{return(await n.A.get("/medical-records")).data.map(e=>(e=>{var a;return{id:e.id,petId:e.pet_id,title:e.title,date:e.date,userDetails:e.user_details||void 0,hospitalDetails:e.hospital_details||void 0,photos:(null==(a=e.photos)?void 0:a.map(e=>({imageData:e.imageData,uploadedBy:e.uploadedBy})))||[]}})(e))}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),l=(0,r.zD)("medical/createRecord",async(e,a)=>{try{return(await n.A.post("/medical-records",e)).data}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),i=(0,r.zD)("medical/updateRecord",async(e,a)=>{try{let{id:a,...t}=e;return(await n.A.put("/medical-records/".concat(a),t)).data}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),s=(0,r.zD)("medical/deleteRecord",async(e,a)=>{try{return await n.A.delete("/medical-records/".concat(e)),e}catch(e){var t,r;return a.rejectWithValue((null==(r=e.response)||null==(t=r.data)?void 0:t.error)||e.message)}}),o=(0,r.Z0)({name:"medical",initialState:{loading:!1,error:null,records:[]},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.records=a.payload}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.loading=!1,e.records.push(a.payload)}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.loading=!1;let t=e.records.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.records[t]=a.payload)}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(s.pending,e=>{e.loading=!0,e.error=null}).addCase(s.fulfilled,(e,a)=>{e.loading=!1,e.records=e.records.filter(e=>e.id!==a.payload)}).addCase(s.rejected,(e,a)=>{e.loading=!1,e.error=a.payload})}}).reducer},6867:(e,a,t)=>{"use strict";t.d(a,{default:()=>D});var r=t(5155),n=t(2115),d=t(4540),l=t(1990);let i=(0,l.Z0)({name:"auth",initialState:{email:"",otp:""},reducers:{setEmail(e,a){e.email=a.payload},clearEmail(e){e.email=""},setOtp(e,a){e.otp=a.payload},clearOtp(e){e.otp=""}}}),{setEmail:s,clearEmail:o,setOtp:c,clearOtp:u}=i.actions,p=i.reducer;var m=t(8141),y=t(7283),g=t(8275),h=t(985),f=t(4183),v=t(6561),A=t(3568),C=t(2274),_=t(7383),j=t(5695),w=t(8084);function D(e){let{children:a}=e,t=(0,j.usePathname)(),i=(0,n.useRef)(null);return i.current||(i.current=(0,l.U1)({reducer:{auth:p,user:m.Ay,pet:y.Ay,appointment:g.Ay,vaccine:h.Ay,vaccineHistory:f.Ay,medical:v.Ay}})),(0,r.jsx)("div",{className:" ".concat(t.includes("login")?" w-full":"max-w-3xl mx-auto"," "),children:(0,r.jsxs)(d.Kq,{store:i.current,children:[(0,r.jsx)(A.l$,{}),(0,r.jsx)(V,{}),a]})})}let V=()=>{let{pets:e}=(0,C.G)(e=>e.pet),{vaccines:a}=(0,C.G)(e=>e.vaccine),{records:t}=(0,C.G)(e=>e.medical),{appointments:d}=(0,C.G)(e=>e.appointment),l=(0,C.j)();return(0,n.useEffect)(()=>{let r=_.A.get("auth_token"),n=async()=>{try{let e=await w.A.get("/auth/profile");l((0,y.Hp)());let a=await e.data.profile;l((0,m.p)(a))}catch(e){console.error("Failed to fetch user profile:",e)}};e.length<=0&&r&&a.length<=0&&t.length<=0&&d.length<=0&&(n(),l((0,y.Hp)()),l((0,h.nO)()),l((0,v.Yt)()),l((0,g.Ns)()))},[l]),(0,r.jsx)(r.Fragment,{})}},7048:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,4147,23)),Promise.resolve().then(t.t.bind(t,8489,23)),Promise.resolve().then(t.t.bind(t,347,23)),Promise.resolve().then(t.bind(t,6867))},7283:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>i,F2:()=>d,Hp:()=>l});var r=t(8084),n=t(1990);let d=(0,n.zD)("pet/registerPet",async(e,a)=>{try{return(await r.A.post("/pet",e)).data}catch(e){var t,n;return a.rejectWithValue((null==e||null==(n=e.response)||null==(t=n.data)?void 0:t.message)||"Failed to register pet")}}),l=(0,n.zD)("pet/fetchPets",async(e,a)=>{try{return(await r.A.get("/pet")).data}catch(e){var t,n;return a.rejectWithValue((null==e||null==(n=e.response)||null==(t=n.data)?void 0:t.message)||"Failed to fetch pets")}}),i=(0,n.Z0)({name:"pet",initialState:{pets:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.pets.push(a.payload)}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to register pet"}).addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.loading=!1,e.pets=a.payload}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to fetch pets"})}}).reducer},8084:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(3464),n=t(7383),d=t(4559);let l=r.A.create({baseURL:d.T});l.interceptors.request.use(e=>{let a=n.A.get("auth_token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,async e=>{var a;let t=e.config;if((null==(a=e.response)?void 0:a.status)===401&&!t._retry){t._retry=!0;try{let e=n.A.get("refresh_token");if(!e)throw Error("Missing refresh token");let a=(await r.A.post("".concat(d.T,"/auth/refresh"),{refresh_token:e})).data.token;return n.A.set("auth_token",a),t.headers.Authorization="Bearer ".concat(a),l(t)}catch(e){return console.error("Refresh token failed:",e),n.A.remove("auth_token"),n.A.remove("refresh_token"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)});let i=l},8141:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>s,ZA:()=>l,d6:()=>i,p:()=>n});let r=(0,t(1990).Z0)({name:"user",initialState:{profile:null},reducers:{setUserProfile:(e,a)=>{e.profile=a.payload},clearUserProfile:e=>{e.profile=null},updateUserEmail:(e,a)=>{e.profile&&(e.profile.email=a.payload)},updateUserPhone:(e,a)=>{e.profile&&(e.profile.phone=a.payload)}}}),{setUserProfile:n,clearUserProfile:d,updateUserEmail:l,updateUserPhone:i}=r.actions,s=r.reducer},8275:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>u,Ns:()=>l,cD:()=>i,d3:()=>c,gG:()=>s});var r=t(1990),n=t(8084);let d=e=>{var a,t,r;return{id:String(e.id),status:e.status,date:e.date.split("T")[0],time:e.time,timeSlot:e.time_slot,numberOfPets:e.number_of_pets,pets:e.pets.map(e=>{var a,t,r,n,d,l;return{selectedPet:{id:String(e.id),name:e.name,type:e.type,gender:null!=(a=e.gender)?a:"",age:null!=(t=e.age)?t:"",weight:null!=(r=e.weight)?r:"",is_neutered:null!=(n=e.is_neutered)&&n},purposeOfVisit:null!=(d=e.purposeOfVisit)?d:"",memo:null!=(l=e.memo)?l:""}}),memberInfo:{firstName:null!=(a=e.member_first_name)?a:"",lastName:null!=(t=e.member_last_name)?t:"",phoneNumber:null!=(r=e.member_phone)?r:""},agreedToPolicy:e.agreed_to_policy}},l=(0,r.zD)("appointments/fetchAppointments",async(e,a)=>{try{return(await n.A.get("/appointments")).data.map(e=>d(e))}catch(e){return a.rejectWithValue(e.message)}}),i=(0,r.zD)("appointments/fetchAppointmentById",async(e,a)=>{try{let a=await n.A.get("/appointments/".concat(e));return d(a.data)}catch(e){return a.rejectWithValue(e.message)}}),s=(0,r.zD)("appointments/createAppointment",async(e,a)=>{try{let a=await n.A.post("/appointments",e);return d(a.data)}catch(e){return a.rejectWithValue(e.message)}}),o=(0,r.zD)("appointments/updateAppointment",async(e,a)=>{try{let{id:a,...t}=e,r=await n.A.put("/appointments/".concat(a),t);return d(r.data)}catch(e){return a.rejectWithValue(e.message)}}),c=(0,r.zD)("appointments/deleteAppointment",async(e,a)=>{try{return await n.A.delete("/appointments/".concat(e)),e}catch(e){return a.rejectWithValue(e.message)}}),u=(0,r.Z0)({name:"appointment",initialState:{loading:!1,error:null,appointments:[],selectedAppointment:null},reducers:{},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0,e.error=null}).addCase(l.fulfilled,(e,a)=>{e.loading=!1,e.appointments=a.payload}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.selectedAppointment=a.payload;let t=e.appointments.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.appointments[t]=a.payload)}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(s.pending,e=>{e.loading=!0,e.error=null}).addCase(s.fulfilled,(e,a)=>{e.loading=!1,e.appointments.push(a.payload)}).addCase(s.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(o.pending,e=>{e.loading=!0,e.error=null}).addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.selectedAppointment=a.payload;let t=e.appointments.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.appointments[t]=a.payload)}).addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{var t;e.loading=!1,e.appointments=e.appointments.filter(e=>e.id!==a.payload),(null==(t=e.selectedAppointment)?void 0:t.id)===a.payload&&(e.selectedAppointment=null)}).addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.payload})}}).reducer},8489:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}}},e=>{e.O(0,[896,122,540,990,568,441,964,358],()=>e(e.s=7048)),_N_E=e.O()}]);